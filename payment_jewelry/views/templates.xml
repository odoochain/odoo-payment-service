<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="page_payment" name="Jewelry Payment Page">
        <t t-call="web.frontend_layout">
            <t t-set="no_header" t-value="True"/>
            <t t-set="no_footer" t-value="True"/>
            <t t-set="class" t-value="True"/>
            <t t-set="title" t-value="website.name"/>
            <t t-set="body_classname" t-value="'payment-page payment-jewelry navbar-light'"/>
            <t t-set="x_icon" t-value="'/web/image?model=website&amp;id=%s&amp;field=favicon' % website.id"/>
            <div class="header row mx-0 card border p-2 px-lg-2 justify-content-between flex-row">
                <div>
                    <img t-att-src="'/p/company/%s/logo' % company.id" t-att-alt="company.name" class="o_company_logo"/>
                </div>
                <!--<t t-call="payment_jetcheckout_system.payment_company"/>-->
                <table class="m-0 table w-auto">
                    <tr>
                        <td class="bg-100 border-right text-right align-middle"><em>Partner : </em></td>
                        <td class="font-weight-bold align-middle"><span t-esc="partner.name"/></td>
                    </tr>
                    <tr>
                        <td class="text-right"></td>
                        <td/>
                    </tr>
                </table>
            </div>
            <div class="px-lg-5">
                <t t-call="payment_jetcheckout_system.payment_state">
                    <t t-set="classes" t-value="'mx-0'"/>
                </t>
                <div class="row mx-0 my-4 card border shadow p-4 flex-row">
                    <div class="col-xl-9 payment-jewelry-items">
                        <t t-foreach="products" t-as="product">
                            <t t-set="brands" t-value="product.get_payment_attribute('brand')"/>
                            <t t-if="brands">
                                <t t-set="brand" t-value="brands[0]"/>
                                <t t-set="weights" t-value="product.get_payment_variants('weight', [brand['id']])"/>
                                <t t-if="weights">
                                    <div t-att-data-id="product.id" t-att-data-name="product.name" t-att-data-foreground="product.payment_color_foreground" t-att-data-background="product.payment_color_background" field="jewelry.items">
                                        <div class="payment-jewelry-items-card">
                                            <div>
                                                <div class="text-nowrap payment-jewelry-items-name" t-attf-style="background-color: #{product.payment_color_background}; color: #{product.payment_color_foreground};">
                                                    <span t-esc="product.name"/>
                                                </div>
                                                <div class="justify-content-start payment-jewelry-items-brand">
                                                    <button class="btn" t-att-data-id="product.id" field="jewelry.brand">
                                                        <img t-attf-src="data:image/png;base64, #{brand['image']}" t-att-alt="brand['name']" t-att-data-id="brand['id']" draggable="false"/>
                                                    </button>
                                                </div>
                                            </div>
                                            <div>
                                                <t t-foreach="weights" t-as="weight">
                                                    <div t-attf-style="border: 2px solid #{product.payment_color_background};">
                                                        <div class="font-weight-bold payment-jewelry-items-weight">
                                                            <span t-attf-style="border-color: #{product.payment_color_background} transparent transparent transparent;"/>
                                                            <span class="mr4" t-esc="weight['name']"/><span>Gram</span>
                                                        </div>
                                                        <div class="font-weight-500">Price</div>
                                                        <div class="payment-jewelry-items-qty">
                                                            <div class="font-weight-bold">
                                                                <button class="btn" t-att-data-id="weight['id']" field="jewelry.plus">
                                                                    <i class="fa fa-2x fa-chevron-up"/>
                                                                </button>
                                                            </div>
                                                            <div>
                                                                <input type="number" min="0" step="1" inputmode="numeric" value="0" class="font-weight-bold" t-att-data-id="weight['id']" t-att-data-name="weight['name']" field="jewelry.qty"/>
                                                            </div>
                                                            <div>
                                                                Unit(s)
                                                            </div>
                                                            <div class="font-weight-bold">
                                                                <button class="btn" t-att-data-id="weight['id']" field="jewelry.minus">
                                                                    <i class="fa fa-2x fa-chevron-down"/>
                                                                </button>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <span class="font-size-125" t-esc="weight['price']" t-att-data-id="weight['id']" t-att-data-value="weight['price']" t-att-data-name="weight['code']" t-options="{'widget': 'monetary', 'display_currency': weight['currency']}" style="border-radius: 3px; padding: 3px;" field="jewelry.price"/>
                                                        </div>
                                                        <div class="font-weight-500 payment-jewelry-items-amount">Amount</div>
                                                        <div>
                                                            <span class="font-size-125" t-esc="0.0" t-att-data-name="product.name" t-att-data-id="weight['id']" t-att-data-qty="0.0" t-att-data-value="0.0" t-att-data-weight="weight['value']" t-options="{'widget': 'monetary', 'display_currency': weight['currency']}" field="jewelry.amount"/>
                                                        </div>
                                                    </div>
                                                </t>
                                            </div>
                                        </div>
                                        <div class="payment-jewelry-items-list">
                                            <div t-attf-style="grid-template-columns: 160px repeat(#{len(weights)}, minmax(100px, 1fr));">
                                                <div class="text-nowrap payment-jewelry-items-name" t-attf-style="background-color: #{product.payment_color_background}; color: #{product.payment_color_foreground};">
                                                    <span t-esc="product.name"/>
                                                </div>
                                                <div class="justify-content-start payment-jewelry-items-brand" t-attf-style="grid-column: 2 / span #{len(weights)};">
                                                    <button class="btn" t-att-data-id="product.id" field="jewelry.brand">
                                                        <img t-att-src="'data:image/png;base64, %s' % brand['image']" t-att-alt="brand['name']" t-att-data-id="brand['id']" draggable="false"/>
                                                    </button>
                                                </div>
                                                <div class="justify-content-end payment-jewelry-items-caption" t-attf-style="border-right: 2px solid #{product.payment_color_background}; border-left: 2px solid #{product.payment_color_background};">
                                                    Gram
                                                </div>
                                                <t t-foreach="weights" t-as="weight">
                                                    <div class="font-weight-bold payment-jewelry-items-weight" t-attf-style="background-color: #{product.payment_color_background}; color: #{product.payment_color_foreground};">
                                                        <span t-esc="weight['name']"/>
                                                    </div>
                                                </t>
                                                <div class="justify-content-end payment-jewelry-items-caption" t-attf-style="border-right: 2px solid #{product.payment_color_background}; border-left: 2px solid #{product.payment_color_background};">
                                                    Price
                                                </div>
                                                <t t-foreach="weights" t-as="weight">
                                                    <div class="text-nowrap">
                                                        <span class="base" t-esc="weight['price']" t-att-data-id="weight['id']" t-att-data-value="weight['price']" t-att-data-name="weight['code']" t-options="{'widget': 'monetary', 'display_currency': weight['currency']}" style="border-radius: 3px; padding: 3px;" field="jewelry.price"/>
                                                    </div>
                                                </t>
                                                <div class="justify-content-end payment-jewelry-items-caption" t-attf-style="border-right: 2px solid #{product.payment_color_background}; border-left: 2px solid #{product.payment_color_background};">
                                                    Quantity
                                                </div>
                                                <t t-foreach="weights" t-as="weight">
                                                    <div class="font-weight-bold payment-jewelry-items-qty" t-attf-style="border: 2px solid #{product.payment_color_background};">
                                                        <input type="number" min="0" step="1" inputmode="numeric" value="0" class="base font-weight-bold" t-att-data-id="weight['id']" t-att-data-name="weight['name']" field="jewelry.qty"/>
                                                    </div>
                                                </t>
                                                <div class="justify-content-end payment-jewelry-items-caption" t-attf-style="border-right: 2px solid #{product.payment_color_background}; border-left: 2px solid #{product.payment_color_background}; border-bottom: 2px solid #{product.payment_color_background}; border-radius: 0 0 10px 10px;">
                                                    Amount
                                                </div>
                                                <t t-foreach="weights" t-as="weight">
                                                    <div class="text-nowrap">
                                                        <span class="base" t-esc="0.0" t-att-data-name="product.name" t-att-data-id="weight['id']" t-att-data-qty="0.0" t-att-data-value="0.0" t-att-data-weight="weight['value']" t-options="{'widget': 'monetary', 'display_currency': weight['currency']}" field="jewelry.amount"/>
                                                    </div>
                                                </t>
                                            </div>
                                        </div>
                                        <t t-foreach="brands" t-as="brand">
                                            <input type="hidden" t-att-data-id="brand['id']" t-att-data-name="brand['name']" t-att-data-image="brand['image']" t-att-data-product="product.id" field="jewelry.brands"/>
                                        </t>
                                    </div>
                                </t>
                            </t>
                        </t>
                    </div>
                    <div class="col-xl-3 payment-jewelry-sidebar">
                        <div>
                            <div class="table-responsive">
                                <table class="table table-borderless">
                                    <thead>
                                        <tr>
                                            <th colspan="2" class="bg-success-light">Order Details</th>
                                        </tr>
                                    </thead>
                                    <tbody field="jewelry.lines">
                                        <tr>
                                            <td colspan="2" class="text-center p-4"><i class="fa fa-3x fa-circle-o-notch fa-spin text-muted"/></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-borderless">
                                    <tbody>
                                        <tr>
                                            <td>Order Net Amount</td>
                                            <td class="text-nowrap text-right"><span t-esc="0.0" t-options="{'widget': 'monetary', 'display_currency': currency}" field="jewelry.subtotal"/></td>
                                        </tr>
                                        <tr>
                                            <td>Service Fee</td>
                                            <td class="text-nowrap text-right"><span t-esc="0.0" t-options="{'widget': 'monetary', 'display_currency': currency}" field="jewelry.fee"/></td>
                                        </tr>
                                        <tr class="bg-success-light font-weight-bold">
                                            <td>Amount to Pay</td>
                                            <td class="text-nowrap text-right"><span t-esc="0.0" t-options="{'widget': 'monetary', 'display_currency': currency}" field="jewelry.total"/></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button class="btn btn-block btn-warning font-weight-bold rounded-0 m-2 p-3" field="jewelry.pay">Pay Now</button>
                            <t t-set="language" t-value="request.env['res.lang']._lang_get(request.env.lang)"/>
                            <input type="hidden" t-att-data-decimal="currency.decimal_places" t-att-data-separator="language.decimal_point" t-att-data-thousand="language.thousands_sep" t-att-data-name="currency.name" t-att-data-id="currency.id" t-att-data-position="currency.position" t-att-data-symbol="currency.symbol" field="currency"/>
                            <input type="hidden" t-att-value="commission" field="jewelry.commission"/>
                            <input type="hidden" name="partner" t-att-value="partner.id" field="partner"/>
                        </div>
                    </div>
                </div>
                <t t-call="payment_jetcheckout_system.payment_agreement"/>
                <t t-call="payment_jetcheckout_system.payment_footer"/>
            </div>
        </t>
    </template>
</odoo>
